<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="TodayVisit">
	<resultMap type="TodayVisit" id="TodayVisitResult">
		<result property="dNo" column="dNo"/>
		<result property="mNo" column="mNo"/>
		<result property="pCode" column="pCode"/>
		<result property="tNo" column="tNo"/>
		<result property="tWork" column="tWork"/>
		<result property="tTime" column="tTime"/>
	</resultMap>
	<select id="DiaryTodayOne" parameterType="int" resultMap="TodayVisitResult">
		select * from TodayVisit where dNo=#{dNo} order by pCode
	</select>
	<insert id="visitInsert" parameterType="TodayVisit">
		<selectKey order="BEFORE" keyProperty="tNo" resultType="int">
	  		select nvl(max(tNo),0)+1 tNo from TodayVisit
	  	</selectKey>
		insert into TodayVisit values(#{dNo}, #{mNo}, #{pCode}, #{tNo}, #{tWork}, #{tTime})
	</insert>
</mapper>